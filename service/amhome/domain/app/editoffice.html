<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
 <HEAD>
  <TITLE> New Document </TITLE>
  <META NAME="Generator" CONTENT="EditPlus">
  <META NAME="Author" CONTENT="">
  <META NAME="Keywords" CONTENT="">
  <META NAME="Description" CONTENT="">
  <script>
  
  //Open Document From URL
//文件的打开操作，可以加相应的参数：只读，读写，打印
function FAI_OCX_OpenDoc(URL,ReadOnly,Print)
{
//if(URL!=null&&URL!="")
//{
    //FAI_OCX_OBJ = document.all.item("FAI_OCX");
    
    //解决bug_id 1712; update by yht
    try{
    
        FAI_OCX_OBJ = document.getElementById("FAI_OCX");
        FAI_OCX_OBJ.OpenFromURL(URL);
    }catch(err){
    
        alert("请设置IE浏览器,允许浏览器安装ActiveX控件后重新进入此页面.");
        return ;
    
    }
  
//读写权限
    if(ReadOnly=="true"||ReadOnly=="True")
    {
        //郭军刚 2007-07-26 修改
        //不显示痕迹
         if((document.all.zwtype.value!=".xls")&&(document.all.zwtype.value!=".xlsx"))
        {
         FAI_OCX_OBJ.SetReadOnly(false);
	     FAI_OCX_OBJ.ActiveDocument.ShowRevisions =false;
	     }
	    
        //设置只读打开
        FAI_OCX_OBJ.SetReadOnly(true);
        //隐藏工具栏
        FAI_OCX_OBJ.Toolbars=true;
        //隐藏工具菜单
        FAI_OCX_OBJ.IsShowToolMenu=true;
        //隐藏菜单
        FAI_OCX_OBJ.Menubar=true;
        //禁止拷贝
        FAI_OCX_OBJ.IsNoCopy=true;
        //禁止保存
        FAI_OCX_OBJ.EnableFileCommand(3) = false;
        //禁止关闭
        FAI_OCX_OBJ.EnableFileCommand(2) = false;
        //禁止另存
        FAI_OCX_OBJ.EnableFileCommand(4) = false;
        //禁止新建
        FAI_OCX_OBJ.EnableFileCommand(0) = false;
        //禁止打开
        //FAI_OCX_OBJ.EnableFileCommand(1) = false;
        

    }
    else
    {
        //设置读写打开
        FAI_OCX_OBJ.SetReadOnly(false);
        //郭军刚 2007-07-26 修改
    	
	   
        //隐藏工具栏
        FAI_OCX_OBJ.Toolbars=true;
        //隐藏工具菜单
        FAI_OCX_OBJ.IsShowToolMenu=true;
        //隐藏菜单
        FAI_OCX_OBJ.Menubar=true;
        //保留痕迹
        if((document.all.zwtype.value!=".xls")&&(document.all.zwtype.value!=".xlsx"))
        {
           //显示痕迹
           FAI_OCX_OBJ.ActiveDocument.ShowRevisions =true;
           FAI_OCX_SetReviewMode(true);
	       FAI_OCX_EnableReviewBar(true);
	    }
        //允许拷贝
        FAI_OCX_OBJ.IsNoCopy=false;
	    FAI_OCX_OBJ.focus();
    }
    //打印控制    
    FAI_OCX_OBJ.EnableFileCommand(5) = true;
//    }
//    else 
//    {
//   alert("文件不存在或者文件被删除！");
//    }
}

  </script>
 </HEAD>
 <BODY onLoad='javascript:FAI_OCX_OpenDoc("http://192.168.1.30:8080/files/test.doc","false","true")'>
		<center>			
			<form id="myForm" method="post" ENCTYPE="multipart/form-data">
				<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
					<tr height="30">
						<td>
							<img src="/domain/app/officeimg/save.gif" id="savedoc" onclick="FAI_OCX_SaveEditToServerDisk(document.all.CurrentID.value);" width="46" height="20" />
							<img src="/domain/app/officeimg/close.gif" onclick="CloseSave();javascript:window.close();" width="46" height="20" />
							<INPUT id="FAI_OCX_Username" type="text"  style="display:none; width: 23px;">
							<input id="CurrentID" style="display:none; width: 8px;"  />
							<input id="TemplateHead" style="display:none; width: 15px;"/>
							<input id="signCircle" style="display:none; width: 9px;" />
							<input id="TemplateID" style="display:none; width: 13px;" />
							<input id="fs" style="display:none; width: 12px;" value="0"/>
							<input id="zwtype" style="display:none; width: 12px;" value="0"/>
						</td>	
					</tr>
					<tr  height="100%"> 
						<td width="100%">
						<OBJECT id="FAI_OCX" codeBase="OfficeControl.cab#version=4,0,1,1" height="100%" width="100%" classid="clsid:C9BC4DFF-4248-4a3c-8A49-63A7D317F404" VIEWASTEXT>
                        <param name="MakerCaption" value="中国一航第一飞机设计研究院">
                        <param name="MakerKey" value="5D909B5A9DD2AB4EB199056706B2D12647431EDA">
                        <param name="ProductCaption" value="陕西维德科技股份有限公司">
                        <param name="ProductKey" value="2C9C976B30048629D5C51D73BBE5350AA12361F9">
                        <PARAM NAME="_ExtentY" VALUE="20981">
                        <PARAM NAME="BorderColor" VALUE="14402205">
                        <PARAM NAME="BackColor" VALUE="-2147483643">
                        <PARAM NAME="ForeColor" VALUE="-2147483640">
                        <PARAM NAME="TitlebarColor" VALUE="14402205">
                        <PARAM NAME="TitlebarTextColor" VALUE="0">
                        <PARAM NAME="BorderStyle" VALUE="1">
                        <PARAM NAME="Titlebar" VALUE="0">
                        <PARAM NAME="Toolbars" VALUE="1">
                        <PARAM NAME="Caption" VALUE="caption">
                        <PARAM NAME="IsShowToolMenu" VALUE="1">
                        <PARAM NAME="IsNoCopy" VALUE="0">
                        <PARAM NAME="IsHiddenOpenURL" VALUE="0">
                        <PARAM NAME="MaxUploadSize" VALUE="0">
                        <PARAM NAME="Menubar" VALUE="1">
                        <PARAM NAME="Statusbar" VALUE="0">
                        <PARAM NAME="FileNew" VALUE="-1">
                        <PARAM NAME="FileOpen" VALUE="-1">
                        <PARAM NAME="ReadOnly" VALUE="1">
                        <PARAM NAME="FileClose" VALUE="-1">
                        <PARAM NAME="FileSave" VALUE="-1">
                        <PARAM NAME="FileSaveAs" VALUE="-1">
                        <PARAM NAME="FilePrint" VALUE="-1">
                        <PARAM NAME="FilePrintPreview" VALUE="-1">
                        <PARAM NAME="FilePageSetup" VALUE="-1">
                        <PARAM NAME="FileProperties" VALUE="-1">
                        <PARAM NAME="IsStrictNoCopy" VALUE="0">
                        <PARAM NAME="IsUseUTF8URL" VALUE="0">
                        <PARAM NAME="MenubarColor" VALUE="-2147483643">
                        <PARAM NAME="IsUseControlAgent" VALUE="0">
                        <PARAM NAME="IsUseUTF8Data" VALUE="0">
                        <PARAM NAME="IsSaveDocExtention" VALUE="0">
                        <PARAM NAME="IsDirectConnect" VALUE="0">
                        <PARAM NAME="SignCursorType" VALUE="0">
                        <PARAM NAME="IsResetToolbarsOnOpen" VALUE="0">
                        <PARAM NAME="IsSaveDataIfHasVDS" VALUE="0">
                        <SPAN STYLE="color:red">不能加载所需的 ActiveX 控件，请检查当前IE安全设置！</SPAN>
                        </OBJECT>
							
						</td>
					</tr>
				</table>
		<input id="docaction" style="display:none"/>  
		<input id="docsign"  style="display:none"/>  
		<input id="dochead" style="display:none"/>  
		<input id="flag" style="display:none"/>  
		<input id="UploadPath" style="display:none"/>  
			</form>
		</center>
 </BODY>
</HTML>
